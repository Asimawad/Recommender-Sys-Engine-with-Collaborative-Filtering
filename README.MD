# Movie Recommendation System using Collaborative Filtering

## Introduction

This project implements a movie recommendation system using collaborative filtering techniques, specifically matrix factorization. The system is designed to predict user preferences for movies based on historical ratings and to generate personalized movie recommendations. By leveraging latent factor models, the system captures underlying patterns in user behavior and movie characteristics. The project uses the MovieLens dataset, which provides a rich source of user ratings and movie metadata.

---

## Table of Contents

- [Project Overview](#project-overview)
- [Project Structure](#project-structure)
- [Installation](#installation)
- [Data Preparation](#data-preparation)
- [Methodology](#methodology)
- [Model Training](#model-training)
- [Evaluation](#evaluation)
- [Usage](#usage)
  - [Generating Recommendations](#generating-recommendations)
  - [Visualizing Embeddings](#visualizing-embeddings)
- [Results](#results)
- [Visualization](#visualization)
- [References](#references)
- [Acknowledgments](#acknowledgments)

---

## Project Overview

The goal of this project is to build a scalable and efficient movie recommendation system using collaborative filtering. The key features include:

- **Data Preprocessing:** Efficient handling of large datasets (e.g., 32 million ratings).
- **Model Training:** Implementation of matrix factorization with bias terms and regularization.
- **Performance Optimization:** Use of advanced data handling libraries such as Polars and performance boosts with tools like JIT compilation.
- **Evaluation:** Metrics like RMSE and loss are tracked to evaluate model performance.
- **Recommendation Generation:** Generate personalized movie recommendations based on user input.
- **Visualization:** Visualizing embeddings to understand latent features of movies and users.

---

## Project Structure

The project is organized as follows:

- **Core Scripts:**
  - `Data_processing.py`: Handles preprocessing of the MovieLens datasets, splitting into train-test sets, and saving necessary mappings and features.
  - `Main.py`: Implements the training loop for the recommendation system, using the best model (`Bias + Users + Movies + Genre Features`).
  - `Inference.py`: Generates movie recommendations using trained models by simulating user preferences.
- **Source Code (`src`):**
  - Modular implementations of the recommendation models:
    - `bias_only_model.py`: Model incorporating only biases.
    - `Bias_U_V_Model.py`: Model including user and movie biases.
    - `Bias_U_V_F_Model.py`: The best model using user, movie, and genre feature biases.
  - Utilities and helper functions for data loading, plotting, and model saving.
- **Directories:**
  - `Data/`: Contains raw datasets such as MovieLens 25M and 32M.
  - `Training_data/`: Stores preprocessed training and testing data.
  - `Experiments_/`: Saves experiment results including trained model parameters, logs, and visualizations.
  - `Predictions/`: Stores sample recommendations generated by different models.
  - `Practical Notebooks/`: Includes notebooks for data analysis, embedding visualizations, and grid search.

---

## Installation

### Prerequisites

Ensure you have the following installed:

- Python 3.7 or higher
- Required libraries from `requirements.txt`:
  - NumPy
  - Pandas
  - Polars
  - Matplotlib
  - Scikit-learn

### Steps

1. **Clone the Repository:**
   ```bash
   git clone https://github.com/your_username/your_repository.git
   cd your_repository
   ```

2. **Set Up a Virtual Environment:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows use `venv\Scripts\activate`
   ```

3. **Install Dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

---

## Data Preparation

### Dataset

The project uses the [MovieLens Dataset](https://grouplens.org/datasets/movielens/), which contains millions of user ratings and movie metadata.

### Steps to Prepare Data

1. **Download the Dataset:** Extract `ml-25m` or `ml-32m` into the `Data/` directory.
2. **Run Data Preprocessing:**
   ```bash
   python Data_processing.py
   ```
   This script processes the data, maps user/movie IDs, splits into train/test, and saves results in `Training_data/`.

---

## Methodology

The recommendation system employs **collaborative filtering** with **matrix factorization** to extract latent features for users and movies. Key model components include:

- **User Factors** (`users_factors`): Represent latent user preferences.
- **Movie Factors** (`movies_factors`): Represent latent movie features.
- **Genre Factors** (`genre_factors`): Capture genre-specific biases.
- **Bias Terms**: Account for user-specific and movie-specific tendencies.

Objective function minimizes the regularized squared error, incorporating:

- Regularization terms for latent factors and biases.
- Learning through alternating least squares (ALS).

---

## Model Training

### Workflow

1. **Run Training:** Execute `Main.py`.
2. **Configure Parameters:** Adjust settings such as `K_factors`, epochs, and regularization terms in `Main.py`.
3. **Save Results:** Trained models, plots, and logs are saved in the respective experiment folder.

---

## Evaluation

### Metrics

- **Root Mean Square Error (RMSE):** Used for training and validation performance.

### Logging and Visualization

- Metrics are logged during training and plotted for analysis.

---

## Usage

### Generating Recommendations

Run `Inference.py` to generate recommendations for a dummy user:

```bash
python Inference.py
```

### Visualizing Embeddings

Use notebooks in `Practical Notebooks/` to visualize embeddings and perform analysis.

---

## Results

- **Training Performance:** Loss and RMSE decrease over epochs.
- **Recommendations:** Relevant and personalized movie suggestions.

---

## References

- [MovieLens Dataset](https://grouplens.org/datasets/movielens/)
- [Matrix Factorization Techniques for Recommender Systems](https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf)

---

## Acknowledgments

- GroupLens Research for the MovieLens dataset.

